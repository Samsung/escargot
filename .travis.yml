sudo: required
language: cpp
compiler:
  - gcc

before_install: sudo apt-get install -y autoconf automake libtool libc++-dev libicu-dev gcc-multilib g++-multilib

matrix:
  include:
    - name: "x64.release"
      script:
        - cmake -H. -Bout/linux/x64/release -DESCARGOT_HOST=linux -DESCARGOT_ARCH=x64 -DESCARGOT_MODE=release -DESCARGOT_OUTPUT=bin
        - make -Cout/linux/x64/release -j2 --quiet
        - cp ./out/linux/x64/release/escargot ./escargot
        - make run-jetstream-only-cdjs
        - travis_wait 30 make run-jetstream-only-simple
        - make run-sunspider-js
        - make run-test262
        - make run-internal-test
        - make run-octane
#       - make run-v8
        - make run-chakracore
        - make run-jsc-stress
#       - make run-spidermonkey

    - name: "x64.debug"
      script:
        - cmake -H. -Bout/linux/x64/debug -DESCARGOT_HOST=linux -DESCARGOT_ARCH=x64 -DESCARGOT_MODE=debug -DESCARGOT_OUTPUT=bin
        - make -Cout/linux/x64/debug -j2 --quiet
        - cp ./out/linux/x64/debug/escargot ./escargot
        - make run-jetstream-only-cdjs
        - make run-sunspider-js
        - make run-test262
        - make run-internal-test

    - name: "x86.release"
      install: "sudo apt-get install -y libicu-dev:i386"
      script:
        - cmake -H. -Bout/linux/x86/release -DESCARGOT_HOST=linux -DESCARGOT_ARCH=x86 -DESCARGOT_MODE=release -DESCARGOT_OUTPUT=bin
        - make -Cout/linux/x86/release -j2 --quiet
        - cp ./out/linux/x86/release/escargot ./escargot
        - make run-jetstream-only-cdjs
        - travis_wait 30 make run-jetstream-only-simple
        - make run-sunspider-js
        - make run-test262
        - make run-internal-test
        - make run-octane
#       - make run-v8
        - make run-chakracore
        - make run-jsc-stress
#       - make run-spidermonkey

    - name: "x86.debug"
      install:
        - "sudo apt-get install -y libicu-dev:i386"
      script:
        - cmake -H. -Bout/linux/x86/debug -DESCARGOT_HOST=linux -DESCARGOT_ARCH=x86 -DESCARGOT_MODE=debug -DESCARGOT_OUTPUT=bin
        - make -Cout/linux/x86/debug -j2 --quiet
        - cp ./out/linux/x86/debug/escargot ./escargot
        - make run-jetstream-only-cdjs
        - make run-sunspider-js
        - make run-test262
        - make run-internal-test

# fast_finish: true
