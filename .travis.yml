language: cpp

# Ubuntu Focal 20.04
os: linux
dist: focal

before_install:
  - echo -n | openssl s_client -connect scan.coverity.com:443 | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' | sudo tee -a /etc/ssl/certs/ca-

addons:
  apt:
    packages: [ninja-build]
  coverity_scan:
    project:
      name: "Samsung/escargot"
      description: "Memory optimized JavaScript engine for mid-range devices."
    notification_email:
      secure: "JfIhVUO4jdJiBiB+2QEyzMJwqb2ilVIwkBGQqxQJAifoyrxR1Wydo0l31Nx00km75/K62zItH3S+/CbWl9rx3acvNKuL3XK0pi2uSl/M32CkaH09GMAzLH1+xeb6Ls00WboB5Zex/m64BORe5oqytfGJ9KZijED49csC6X7ycpSUryXGdreRsDlRmZKqJ7E6gfh9+2PDeA44vk8FE8L7XkZ12cu5xtMaWjMeBLmMJScXv+jDXFbSp7nVuISPlRmXQINInU/Eh6MIr3FfOmtbEB/LM3G3yYuVQ3UfOCCa2vUpmjWl80r7t1wcwhX70IejCJ+s0fFet1oC5DzxyNw0pC28jS5HFA1UQ9HfoafUCYR4ejaLceBHW5u19OS99nbyc56RNJjzFsubnofYxYLcECu9lPucfpfQxSsQnZdjvLlUonwG/LA/OFZlcYfy6BJ72VqNnM0eS11krzgw+BUlKaIO30rpmEiJTdJ3vMYrcNLa7ZINJctgxeExaWoIjNn6ePgmI9TQG85I6oBRQWr3cxdR/NwKUWj7KYdJuwvVYI03L9LNZPprMh73gOf7v2wqj4JNPEz99CBp6glGGgR3+Ob2N7fesMl6/kA9O4FV0NE1zNWFGV+NEOHU1y9f8tiJphS7B2DNXk+4Qzx6rGzzmK8e6PEqEhEIIRPK5ZYWIrI="
    build_command_prepend: "cmake -H./ -Bout/release -DESCARGOT_HOST=linux -DESCARGOT_ARCH=x64 -DESCARGOT_MODE=release -DESCARGOT_OUTPUT=shell_test -GNinja"
    build_command: "ninja -Cout/release"
    branch_pattern: master

script:
  - cmake -H./ -Bout/release -DESCARGOT_HOST=linux -DESCARGOT_ARCH=x64 -DESCARGOT_MODE=release -DESCARGOT_OUTPUT=shell_test -GNinja
  - ninja -Cout/release

notifications:
  email: false
